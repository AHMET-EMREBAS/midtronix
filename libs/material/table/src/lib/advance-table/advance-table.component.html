<ng-container *ngIf="query$ | async"></ng-container>

<div class="table-container">
  <mat-form-field appearance="fill">
    <input
      type="search"
      #searchInput="ngModel"
      ngModel
      matInput
      placeholder="Search"
      autocomplete="off"
      (input)="search$.next(searchInput.value)"
    />
  </mat-form-field>

  <mat-table
    #tableRef
    *ngIf="data"
    [dataSource]="data"
    matSort
    matSortActive="created"
    matSortDisableClear
    matSortDirection="desc"
    (matSortChange)="sort$.next($event)"
  >
    <ng-container matColumnDef="__firstColumn">
      <mat-header-cell *matHeaderCellDef mat-sort-header disableClear>
      </mat-header-cell>
      <mat-cell *matCellDef="let row">
        <button mat-icon-button (click)="editButtonClickEvent.emit(row)">
          <mat-icon>edit</mat-icon>
        </button>
      </mat-cell>
    </ng-container>

    @for(col of columns;track col){
    <ng-container [matColumnDef]="col.name.toString()">
      <mat-header-cell *matHeaderCellDef mat-sort-header disableClear>
        {{ col.label || col.name }}
      </mat-header-cell>
      <mat-cell *matCellDef="let row"> {{ row[col.name] }} </mat-cell>
    </ng-container>
    }

    <mat-header-row *matHeaderRowDef="getColumnNames()"></mat-header-row>
    <mat-row *matRowDef="let row; columns: getColumnNames()"></mat-row>
  </mat-table>

  <mat-paginator
    #paginatorRef
    [length]="service.count$ | async"
    [pageIndex]="0"
    [pageSize]="4"
    [pageSizeOptions]="[4, 8, 12, 16, 20]"
    (page)="page$.next($event)"
  ></mat-paginator>
</div>
